<canvas id="z" width=400 height=400>
<script>
style='fillStyle';
draw='fillRect';
ctx=z.getContext('2d');
ctx.font="20px Arial";
movLookup=[-1,-20,1,twenty=20];
function reset(fully){
	if(fully){
		positions=[0];
		moveDir=2;
	}
	foodPos=~~(numTiles*Math.random());
	canChangeDir=1;
	isGameOver=0
}
reset(numTiles=400);
document.onkeydown=function(evt){
	whichKey=evt.which;
	if(canChangeDir&36<whichKey&whichKey<41&moveDir%2==whichKey%2){moveDir=whichKey-37;canChangeDir=0}
	if(isGameOver&whichKey==32){reset(1)}
};
setInterval(function(){
	//draw background
	ctx[style]="#cfb";
	ctx[draw](0,0,numTiles,numTiles);
	ctx[style]="#444";
	if(isGameOver){
		ctx.fillText("Game Over! Press Space to start",50,160)
	}
	else{
		//move snake
		positions.unshift(positions[0]+movLookup[moveDir]);
		tempPos0=positions[0];
		positions.pop();
		//eat food
		if(tempPos0==foodPos){
			positions.push(-1);
			reset()
		}
		//draw snake
		for(i in positions){
			tempPos2=positions[i];
			if(i>0&tempPos0==tempPos2){isGameOver=1}
			ctx[draw](tempPos2%twenty*twenty,~~(tempPos2/twenty)*twenty,nineteen=19,nineteen)
		}
		canChangeDir=1;
		//check for out of bounds
		outOfBoundsAlongEdges=tempPos0%twenty-moveDir;
		if(tempPos0<0|tempPos0>numTiles|!(moveDir%2|outOfBoundsAlongEdges!=-2&outOfBoundsAlongEdges!=nineteen)){isGameOver=1}
		//draw food
		ctx[style]="#f01";
		ctx[draw](foodPos%twenty*twenty,~~(foodPos/twenty)*twenty,nineteen,nineteen)
	}
},99);
</script>