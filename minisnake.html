<canvas id="a" width=400 height=400 />
<script>
f=Math.floor;
r=Math.random;
z=document;
c=z.getElementById('a').getContext('2d');
function reset(partial) {
	if(!partial){
		pos=[[9,9]];
		dir=97;
	}
	food=[f(20*r()),f(20*r())];
	changed=false;
}
reset();
z.onkeypress = function(evt) {
	if(!changed&&dir%12>5!=evt.which%12>5){dir = evt.which;changed=true;}
};
setInterval(function(){
	//draw background
	c.fillStyle="#cfb";
	c.fillRect(0,0,400,400);
	//move snake
	pos.unshift([
		pos[0][0]-f((dir%14-3)/10),
		pos[0][1]+f((dir%13-3)/8)
	]);
	pos.pop();
	//check for out of bounds
	if(pos[0][0]<0 || pos[0][1]<0 || pos[0][0]>19 || pos[0][1]>19){reset();}
	//eat food
	if(pos[0][0]==food[0] && pos[0][1]==food[1]){
		pos.push([food]);
		reset(1);
	}
	//draw food
	c.fillStyle="#f01";
	c.fillRect(20*food[0],20*food[1],19,19);
	//draw snake
	c.fillStyle="#444";
	for(i=0;i<pos.length;i++){
		c.fillRect(20*pos[i][0],20*pos[i][1],19,19);
		if(i>0 && pos[i][0]==pos[0][0] && pos[i][1]==pos[0][1]){reset();}
	}
	changed=false;
},99);
</script>