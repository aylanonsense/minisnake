<canvas id="a" width=400 height=400 />
<script>
f=Math.floor;
r=Math.random;
z=document;
c=z.getElementById('a').getContext('2d');
function reset(partial) {
	if(!partial){
		pos=[{x:9,y:9}];
		dir=97;
	}
	food={x:f(20*r()),y:f(20*r())};
	changed=false;
}
reset();
z.onkeypress = function(evt) {
	if(!changed&&dir%12>5!=evt.which%12>5){dir = evt.which;changed=true;}
};
setInterval(function(){
	//draw background
	c.fillStyle="#cfb";
	c.fillRect(0,0,400,400);
	//move snake
	pos.unshift({
		x:pos[0].x-f((dir%14-3)/10),
		y:pos[0].y+f((dir%13-3)/8)
	});
	pos.pop();
	//check for out of bounds
	if(pos[0].x<0 || pos[0].y<0 || pos[0].x>19 || pos[0].y>19){reset();}
	//eat food
	if(pos[0].x==food.x && pos[0].y==food.y){
		pos.push([food]);
		reset(1);
	}
	//draw food
	c.fillStyle="#f01";
	c.fillRect(20*food.x,20*food.y,19,19);
	//draw snake
	c.fillStyle="#444";
	for(i=0;i<pos.length;i++){
		c.fillRect(20*pos[i].x,20*pos[i].y,19,19);
		if(i>0 && pos[i].x==pos[0].x && pos[i].y==pos[0].y){reset();}
	}
	changed=false;
},99);
</script>