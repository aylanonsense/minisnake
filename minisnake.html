<canvas id="a" width=400 height=400 />
<script>
s='fillStyle';
b='fillRect';
f=Math.floor;
r=Math.random;
z=document;
c=z.getElementById('a').getContext('2d');
function reset(partial) {
	if(!partial){
		pos=[{x:9,y:9}];
		dir=97;
	}
	food={x:f(20*r()),y:f(20*r())};
	changed=false;
}
reset();
z.onkeypress = function(evt) {
	if(!changed&&dir%12>5!=evt.which%12>5){dir = evt.which;changed=true;}
};
setInterval(function(){
	//draw background
	c[s]="#cfb";
	c[b](0,0,400,400);
	//move snake
	o=pos[0];
	pos.unshift({
		x:o.x-f((dir%14-3)/10),
		y:o.y+f((dir%13-3)/8)
	});
	o=pos[0].x;
	q=pos[0].y;
	pos.pop();
	//check for out of bounds
	if(o<0 || q<0 || o>19 || q>19){reset();}
	//eat food
	if(o==food.x && q==food.y){
		pos.push([food]);
		reset(1);
	}
	//draw food
	c[s]="#f01";
	c[b](20*food.x,20*food.y,19,19);
	//draw snake
	c[s]="#444";
	for(i in pos){
		t=pos[i].x;
		v=pos[i].y;
		c[b](20*t,20*v,19,19);
		if(i>0 && t==o && v==q){reset();}
	}
	changed=false;
},99);
</script>